import { experimentalStyled as styled } from "@material-ui/core/styles";
import { useEffect, useState } from "react";
import { List, ListItem } from "@material-ui/core";
import sendCommand from "./Commands";
import { Dispatch, SetStateAction } from "react";
import {
  Dialog,
  DialogTitle,
  DialogContent,
  DialogActions,
} from "@material-ui/core";
import Button from "@material-ui/core/Button";

const SDialog = styled(DialogContent)`
  width: 150px;
`

const SList = styled(List)`
  height: 150px;
`

const Li = styled(ListItem)`
  text-align: center;
  justify-content: center;
`

const SButton = styled(Button)`
    color: ${({theme}) => theme.palette.text.secondary};
`

const serverurl = process.env.SERVER_URL || "http://localhost:3001";
const DeleteRunsheetDialog = (props: {
  open: boolean;
  cb: Dispatch<SetStateAction<boolean>>;
}) => {
  const initialState: string[] = [];
  const [runsheets, setRunsheets] = useState(initialState);
  useEffect(() => {fetch(`${serverurl}/runsheets`)
  .then((res) => res.json())
  .then((runsheets) => setRunsheets(runsheets));}, []);
  return (
    <Dialog
      open={props.open}
      onClose={() => {
        props.cb(false);
      }}
      scroll={"body"}
    >
      <DialogTitle id="form-edit">Delete Runsheet</DialogTitle>
      <SDialog dividers={false}>
        <SList>
          {runsheets.map((value: string) => (
            <Li key={value}
              button
              onClick={() => {
                sendCommand("deleterunsheet", "", "", value);
                props.cb(false);
              }}
            >
              {value}
            </Li>
          ))}
        </SList>
      </SDialog>
      <DialogActions>
        <SButton onClick={() => props.cb(false)}>Cancel</SButton>
      </DialogActions>
    </Dialog>
  );
};

export default DeleteRunsheetDialog;
